<dataConfig>

 <dataSource type="JdbcDataSource" 
             driver="com.mysql.jdbc.Driver" 
             url="jdbc:mysql://localhost:3306/mlgb" 
             batchSize="-1" 
             convertType="true" 
             user="mlgbAdmin" 
             password="blessing"/>

  <document>
    <entity name="books" 
      query="select books_book.id, 
                    books_book.provenance_id, 
                    books_book.modern_location_1_id, 
                    books_book.modern_location_2_id, 
                    books_book.shelfmark_1,
                    books_book.shelfmark_2,
                    books_book.evidence_id,
                    books_book.author_title,
                    books_book.date,
                    books_book.pressmark,
                    books_book.medieval_catalogue,
                    books_book.unknown,
                    books_book.notes,
                    IFNULL(books_contains.contains,'') as ac 
             from 
                    books_book 
             left join 
                    books_contains on book_id_id=books_book.id">

      <field column="id" name="id"/>
      <field column="shelfmark_1"        name="sm1"/>
      <field column="shelfmark_2"        name="sm2"/>
      <field column="evidence_id"        name="ev"/>
      <field column="author_title"       name="soc"/>
      <field column="date"               name="dt"/>
      <field column="pressmark"          name="pm"/>
      <field column="medieval_catalogue" name="mc"/>
      <field column="unknown"            name="uk"/>
      <field column="notes"              name="nt"/>
      <field column="ac"                 name="ac"/>

      <entity name="pr"
        query="select provenance, 
                      IFNULL(county,'') as county, 
                      IFNULL(institution,'') as institution 
               from books_provenance 
               where id ='${books.provenance_id}'">

        <field column="provenance" name="pr"/>
        <field column="county" name="ct"/>
        <field column="institution" name="ins"/>
      </entity>

      <entity name="ml1"
        query="select modern_location_1 
               from books_modern_location_1 
               where id ='${books.modern_location_1_id}'">

        <field column="modern_location_1" name="ml1"/> 
      </entity>

      <entity name="ml2"
        query="select modern_location_2 
               from books_modern_location_2 
               where id ='${books.modern_location_2_id}'">

        <field column="modern_location_2" name="ml2"/> 
      </entity>

      <entity name="evd"
        query="select evidence_description 
               from books_evidence
               where evidence ='${books.evidence_id}'">

        <field column="evidence_description" name="evdesc"/> 
      </entity>

    </entity> <!-- end entity "books" -->
  </document>
</dataConfig>

